<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kerberos Authentication &mdash; Ansible Community Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5707b69d" />
      <link rel="stylesheet" type="text/css" href="../_static/css/ansible.css?v=c5b67dd2" />
      <link rel="stylesheet" type="text/css" href="../_static/antsibull-minimal.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/rtd-ethical-ads.css?v=289b023e" />

  
    <link rel="shortcut icon" href="../_static/images/Ansible-Mark-RGB_Black.png"/>
    <link rel="canonical" href="https://docs.ansible.com/ansible/latest/os_guide/windows_winrm_kerberos.html"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=c7b8e248"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ansible tips and tricks" href="../tips_tricks/index.html" />
    <link rel="prev" title="WinRM Certificate Authentication" href="windows_winrm_certificate.html" /><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->
<script src="https://www.redhat.com/dtm.js"></script>


<!-- <meta class="swiftype" name="published_at" data-type="date" content="2017-12-13" /> -->
<meta class="swiftype" name="version" data-type="string" content="devel">

<!-- Google Tag Manager Data Layer -->
<script>
 dataLayer = [];
</script>
<!-- End Google Tag Manager Data Layer -->



<script>
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','https://s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

</head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->
<!-- Google Tag Manager -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
<!-- End Google Tag Manager -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
    <li><a href="https://forum.ansible.com/" target="_blank">Ansible community forum</a></li>
    <li><a href="https://docs.ansible.com/" target="_blank">Documentation</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="../_static/images/Ansible-Mark-RGB_White.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">Ansible Community Documentation</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Ansible
          </a>
              <div class="version">
                devel
              </div><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    <form class="version-dropdown" method="get">
      <script>
        function switchVersionTo(slug) {
          var current_url_path = window.location.pathname;
          var url_version = current_url_path.search("/devel/") > -1
            ? "/devel/"
            : "/latest/";
          var new_version_url = current_url_path.replace(url_version, "/" + slug + "/");
          window.location.replace(new_version_url);
        }
      </script>
      <label class="sr-only" for="version-list">Select version:</label>
      <select
          class="version-list"
          id="version-list"
          onchange="switchVersionTo(this.value);"
      >
        
        <option
            value="latest"
            
        >
            latest
        </option>
        
        <option
            value="9"
            
        >
            9
        </option>
        
        <option
            value="2.9"
            
        >
            2.9
        </option>
        
        <option
            value="devel"
            selected="selected"
        >
            devel
        </option>
        
      </select>
    </form>
  
</div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" method="get">
    <label class="sr-only" for="q">Search docs:</label>
    <input type="text" class="st-default-search-input" id="q" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Ansible getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting started with Ansible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started_ee/index.html">Getting started with Execution Environments</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation, Upgrade &amp; Configuration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation_guide/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting_guides/porting_guides.html">Ansible Porting Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Ansible</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../inventory_guide/index.html">Building Ansible inventories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_guide/index.html">Using Ansible command line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../playbook_guide/index.html">Using Ansible playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vault_guide/index.html">Protecting sensitive data with Ansible vault</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_plugin_guide/index.html">Using Ansible modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections_guide/index.html">Using Ansible collections</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Using Ansible on Windows and BSD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro_bsd.html">Managing BSD hosts with Ansible</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="intro_windows.html">Managing Windows hosts with Ansible</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="windows_dsc.html">Desired State Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_performance.html">Windows performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_ssh.html">Windows SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_usage.html">Using Ansible and Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_winrm.html">Windows Remote Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="windows_winrm_certificate.html">WinRM Certificate Authentication</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Kerberos Authentication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-kerberos">Installing Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuring-host-kerberos">Configuring Host Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verifying-kerberos-configuration">Verifying Kerberos Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ticket-management">Ticket Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delegation">Delegation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#troubleshooting-kerberos">Troubleshooting Kerberos</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#bootstrapping-windows">Bootstrapping Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#connecting-to-windows-nodes">Connecting to Windows nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#which-modules-are-available">Which modules are available?</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#using-windows-as-the-control-node">Using Windows as the control node</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#windows-facts">Windows facts</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro_windows.html#common-windows-problems">Common Windows problems</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tips_tricks/index.html">Ansible tips and tricks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">Ansible Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions_collections.html">Ansible Collections Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/contributions.html">ansible-core Contributors Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community/advanced_index.html">Advanced Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/style_guide/index.html">Ansible documentation style guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extending Ansible</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/index.html">Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Common Ansible Scenarios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../scenario_guides/cloud_guides.html">Legacy Public Cloud Guides</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Network Automation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/getting_started/index.html">Network Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/user_guide/index.html">Network Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dev_guide/index.html">Network Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ansible Galaxy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/user_guide.html">Galaxy User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../galaxy/dev_guide.html">Galaxy Developer Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference &amp; Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../collections/index.html">Collection Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../collections/all_plugins.html">Indexes of all modules and plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/playbooks_keywords.html">Playbook Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/common_return_values.html">Return Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/config.html">Ansible Configuration Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/general_precedence.html">Controlling how Ansible behaves: precedence rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/YAMLSyntax.html">YAML Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/python_3_support.html">Python 3 Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/interpreter_discovery.html">Interpreter Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/release_and_maintenance.html">Releases and maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/test_strategies.html">Testing Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/testing/sanity/index.html">Sanity Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/module_utils.html">Ansible Reference: Module Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/special_variables.html">Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/tower.html">Red Hat Ansible Automation Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/automationhub.html">Ansible Automation Hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_appendices/logging.html">Logging Ansible output</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Roadmaps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_roadmap_index.html">Ansible Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/ansible_core_roadmap_index.html">ansible-core Roadmaps</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->
<!-- changeable widget links to tower - do not change as image controlled by Ansible-->
<div id="sideBanner">
  <br/>
  <a href="https://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
  </a>
  <br/><br/><br/>
</div>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Ansible</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Using Ansible on Windows and BSD</a></li>
          <li class="breadcrumb-item"><a href="intro_windows.html">Managing Windows hosts with Ansible</a></li>
      <li class="breadcrumb-item active">Kerberos Authentication</li>
  <li class="wy-breadcrumbs-aside">
            <!-- Remove main index page as it is no longer editable -->
            
              <a href="https://github.com/ansible/ansible-documentation/edit/devel/docs/docsite/rst/os_guide/windows_winrm_kerberos.rst?description=%23%23%23%23%23%20SUMMARY%0A%3C!---%20Your%20description%20here%20--%3E%0A%0A%0A%23%23%23%23%23%20ISSUE%20TYPE%0A-%20Docs%20Pull%20Request%0A%0A%2Blabel:%20docsite_pr" class="fa fa-github"> Edit on GitHub</a>
            
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  <script>
    function startsWith(str, needle) {
      return str.slice(0, needle.length) == needle
    }
    function startsWithOneOf(str, needles) {
      return needles.some(function (needle) {
        return startsWith(str, needle);
      });
    }
    var banner = '';
      var extra_banner = '';
    /*use extra_banner for when we want something extra, like a survey or Community Day notice */
   /*  var extra_banner =
      '<div id="latest_extra_banner_id" class="admonition important">' +
        '<p style="padding-bottom: 1.2rem;">' +
        'Discuss Ansible in the new <a href="https://forum.ansible.com/t/welcome-to-the-ansible-community/5">Ansible Forum!</a>' +
        '</p>' +
      '</div>';
      */
    // Create a banner if we're not on the official docs site
    if (location.host == "docs.testing.ansible.com") {
      document.write('<div id="testing_banner_id" class="admonition important">' +
                     '<p>This is the testing site for Ansible Documentation. Unless you are reviewing pre-production changes, please visit the <a href="https://docs.ansible.com/ansible/latest/">official documentation website</a>.</p> <p></p>' +
                     '</div>');
    }
    
      // Create a banner
      current_url_path = window.location.pathname;

      var important = false;
      var msg = '<p>';
      if (startsWith(current_url_path, "/ansible-core/")) {
        msg += 'You are reading documentation for Ansible Core, which contains no plugins except for those in ansible.builtin. For documentation of the Ansible package, go to <a href="/ansible/latest">the latest documentation</a>.';
      } else if (startsWithOneOf(current_url_path, ["/ansible/latest/", "/ansible/10/"])) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'This is the <b>latest</b> (stable) Ansible community documentation. For Red Hat Ansible Automation Platform subscriptions, see <a href="https://access.redhat.com/support/policy/updates/ansible-automation-platform">Life Cycle</a> for version details.';
      } else if (startsWith(current_url_path, "/ansible/2.9/")) {
        msg += 'You are reading the latest Red Hat released version of the Ansible documentation. Community users can use this version, or select <b>latest</b> from the version selector to the left for the most recent community version.';
      } else if (startsWith(current_url_path, "/ansible/devel/")) {
        /* temp extra banner to advertise something */
        banner += extra_banner;

        msg += 'You are reading the <b>devel</b> version of the Ansible documentation - this version is not guaranteed stable. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
      } else {
        msg += 'You are reading an older version of the Ansible documentation. Use the version selection to the left if you want the <b>latest</b> (stable) released version.';
        /* temp extra banner to advertise something - this is for testing*/
        banner += extra_banner;

      }
      msg += '</p>';

      banner += '<div id="banner_id" class="admonition ';
      banner += important ? 'important' : 'caution';
      banner += '">';
      banner += important ? '<br>' : '';
      banner += msg;
      banner += important ? '<br>' : '';
      banner += '</div>';
      document.write(banner);
    
  </script>


  
           <div itemprop="articleBody">
             
  <section id="kerberos-authentication">
<span id="windows-winrm-kerberos"></span><h1>Kerberos Authentication<a class="headerlink" href="#kerberos-authentication" title="Link to this heading"></a></h1>
<p>Kerberos authentication is a modern method used in Windows environments for authentication. It allows both the client and server to verify each others identities and supports modern encryption methods like AES.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#installing-kerberos" id="id1">Installing Kerberos</a></p></li>
<li><p><a class="reference internal" href="#configuring-host-kerberos" id="id2">Configuring Host Kerberos</a></p></li>
<li><p><a class="reference internal" href="#verifying-kerberos-configuration" id="id3">Verifying Kerberos Configuration</a></p></li>
<li><p><a class="reference internal" href="#ticket-management" id="id4">Ticket Management</a></p></li>
<li><p><a class="reference internal" href="#delegation" id="id5">Delegation</a></p></li>
<li><p><a class="reference internal" href="#troubleshooting-kerberos" id="id6">Troubleshooting Kerberos</a></p></li>
</ul>
</nav>
<section id="installing-kerberos">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Installing Kerberos</a><a class="headerlink" href="#installing-kerberos" title="Link to this heading"></a></h2>
<p>Kerberos is provided through a GSSAPI library which is part of a system package. Some distributions install the Kerberos packages by default but others may require manual installation.</p>
<p>To install the Kerberos libraries on a RHEL/Fedora based system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>krb5-devel<span class="w"> </span>krb5-libs<span class="w"> </span>krb5-workstation<span class="w"> </span>python3-devel
</pre></div>
</div>
<p>For a Debian/Ubuntu based system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>krb5-user<span class="w"> </span>libkrb5-dev<span class="w"> </span>python3-dev
</pre></div>
</div>
<p>For an Arch Linux based system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>pacman<span class="w"> </span>-S<span class="w"> </span>krb5
</pre></div>
</div>
<p>For a FreeBSD based system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>pkg<span class="w"> </span>install<span class="w"> </span>heimdal
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">python3-devel</span></code> / <code class="docutils literal notranslate"><span class="pre">python3-dev</span></code> packages can be ignored if using Kerberos with the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> connection plugin. They are only needed if using a WinRM based connection with Kerberos authentication.</p>
</div>
<p>Once installed the <code class="docutils literal notranslate"><span class="pre">kinit</span></code>, <code class="docutils literal notranslate"><span class="pre">klist</span></code>, and <code class="docutils literal notranslate"><span class="pre">krb5-config</span></code> packages will be available. You can test them out with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>krb5-config<span class="w"> </span>--version

Kerberos<span class="w"> </span><span class="m">5</span><span class="w"> </span>release<span class="w"> </span><span class="m">1</span>.21.3
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">psrp</span></code> and <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection plugins require extra Python libraries for Kerberos authentication. The following step can be skipped if using Kerberos with the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> connection.</p>
<p>If you chose the <code class="docutils literal notranslate"><span class="pre">pipx</span></code> install instructions for Ansible, you can install those requirements by running the following:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pipx<span class="w"> </span>inject<span class="w"> </span><span class="s2">&quot;pypsrp[kerberos]&lt;=1.0.0&quot;</span><span class="w">  </span><span class="c1"># for psrp</span>
pipx<span class="w"> </span>inject<span class="w"> </span><span class="s2">&quot;pywinrm[kerberos]&gt;=0.4.0&quot;</span><span class="w">  </span><span class="c1"># for winrm</span>
</pre></div>
</div>
<p>Or, if you chose the <code class="docutils literal notranslate"><span class="pre">pip</span></code> install instructions:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pypsrp[kerberos]&lt;=1.0.0&quot;</span><span class="w">  </span><span class="c1"># for psrp</span>
pip3<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pywinrm[kerberos]&gt;=0.4.0&quot;</span><span class="w">  </span><span class="c1"># for winrm</span>
</pre></div>
</div>
</section>
<section id="configuring-host-kerberos">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Configuring Host Kerberos</a><a class="headerlink" href="#configuring-host-kerberos" title="Link to this heading"></a></h2>
<p>Once the dependencies have been installed, Kerberos needs to be configured so that it can communicate with a domain. Most Kerberos implementations can either find a domain using DNS or through manual configuration in the <code class="docutils literal notranslate"><span class="pre">/etc/krb5.conf</span></code> file. For details on what can be set in the <code class="docutils literal notranslate"><span class="pre">/etc/krb5.conf</span></code> file see <a class="reference external" href="https://web.mit.edu/kerberos/krb5-latest/doc/admin/conf_files/krb5_conf.html">krb5.conf</a> for more details. A simple <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> file that uses DNS to lookup the KDC would be:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[libdefaults]</span>
<span class="w">    </span><span class="c1"># Not required but helpful if the realm cannot be determined from</span>
<span class="w">    </span><span class="c1"># the hostname</span>
<span class="w">    </span><span class="na">default_realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">MY.DOMAIN.COM</span>

<span class="w">    </span><span class="c1"># Enabled KDC lookups from DNS SRV records</span>
<span class="w">    </span><span class="na">dns_lookup_kdc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span>
</pre></div>
</div>
<p>With the above configuration when a Kerberos ticket is requested for the server <code class="docutils literal notranslate"><span class="pre">server.my.domain.com</span></code> the Kerberos library will do an SRV lookup for <code class="docutils literal notranslate"><span class="pre">_kerberos._udp.my.domain.com</span></code> and <code class="docutils literal notranslate"><span class="pre">_kerberos._tcp.my.domain.com</span></code> to find the KDC. If you wish to manually set the KDC realms you can use the following configuration:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[libdefaults]</span>
<span class="w">    </span><span class="na">default_realm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">MY.DOMAIN.COM</span>
<span class="w">    </span><span class="na">dns_lookup_kdc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span>

<span class="k">[realms]</span>
<span class="w">    </span><span class="na">MY.DOMAIN.COM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{</span>
<span class="w">        </span><span class="na">kdc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">domain-controller1.my.domain.com</span>
<span class="w">        </span><span class="na">kdc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">domain-controller2.my.domain.com</span>
<span class="w">    </span><span class="na">}</span>

<span class="k">[domain_realm]</span>
<span class="w">    </span><span class="na">.my.domain.com</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">MY.DOMAIN.COM</span>
<span class="w">    </span><span class="na">my.domain.com</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">MY.DOMAIN.COM</span>
</pre></div>
</div>
<p>With this configuration any request for a ticket with the DNS suffix <code class="docutils literal notranslate"><span class="pre">.my.domain.com</span></code> and <code class="docutils literal notranslate"><span class="pre">my.domain.com</span></code> itself will be sent to the KDC <code class="docutils literal notranslate"><span class="pre">domain-controller1.my.domain.com</span></code> with a fallback to <code class="docutils literal notranslate"><span class="pre">domain-controller2.my.domain.com</span></code>.</p>
<p>More information on how the Kerberos library attempts to find the KDC can be found in the <a class="reference external" href="https://web.mit.edu/kerberos/krb5-latest/doc/admin/realm_config.html">MIT Kerberos Documentation</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The information in this section assumes you are using the MIT Kerberos implementation which is typically the default on most Linux distributions. Some platforms like FreeBSD or macOS use a different GSSAPI implementation called Heimdal which acts in a similar way to MIT Kerberos but some behaviors may be different.</p>
</div>
</section>
<section id="verifying-kerberos-configuration">
<span id="winrm-kerberos-verify-config"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Verifying Kerberos Configuration</a><a class="headerlink" href="#verifying-kerberos-configuration" title="Link to this heading"></a></h2>
<p>To verify that Kerberos is working correctly, you can use the <code class="docutils literal notranslate"><span class="pre">kinit</span></code> command to obtain a ticket for a user in the domain. The following command will request a ticket for the user <code class="docutils literal notranslate"><span class="pre">username</span></code> in the domain <code class="docutils literal notranslate"><span class="pre">MY.DOMAIN.COM</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kinit<span class="w"> </span>username@MY.DOMAIN.COM
Password<span class="w"> </span><span class="k">for</span><span class="w"> </span>username@REALM.COM
</pre></div>
</div>
<p>If the password is correct, the command will return without any output. To verify that the ticket has been obtained, you can use the <code class="docutils literal notranslate"><span class="pre">klist</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt;<span class="w"> </span>klist
Ticket<span class="w"> </span>cache:<span class="w"> </span>KCM:1000
Default<span class="w"> </span>principal:<span class="w"> </span>username@MY.DOMAIN.COM

Valid<span class="w"> </span>starting<span class="w">     </span>Expires<span class="w">            </span>Service<span class="w"> </span>principal
<span class="m">29</span>/08/24<span class="w"> </span><span class="m">13</span>:54:51<span class="w">  </span><span class="m">29</span>/08/24<span class="w"> </span><span class="m">23</span>:54:51<span class="w">  </span>krbtgt/MY.DOMAIN.COM@MY.DOMAIN.COM
<span class="w">        </span>renew<span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="m">05</span>/09/24<span class="w"> </span><span class="m">13</span>:54:48
</pre></div>
</div>
<p>If successful, this validates that the Kerberos configuration is correct and that the user can obtain a Ticket Granting Ticket (<code class="docutils literal notranslate"><span class="pre">TGT</span></code>) from the KDC. If <code class="docutils literal notranslate"><span class="pre">kinit</span></code> is unable to find the KDC for the requested realm, verify your Kerberos configuration by ensuring DNS can locate the KDC using the SRV records or that the KDC is manually mapped in the <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code>.</p>
<p>On MIT Kerberos based systems, you can use the <code class="docutils literal notranslate"><span class="pre">kvno</span></code> command to verify that you are able to retrieve a service ticket for a particular service. For example, if you are using a WinRM based connection to authenticate with <code class="docutils literal notranslate"><span class="pre">server.my.domain.com</span></code> you can use the following command to verify that your TGT is able to get a service ticket for the target server:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>kvno<span class="w"> </span>http/server.my.domain.com
http/server2025.domain.test@DOMAIN.TEST:<span class="w"> </span><span class="nv">kvno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">klist</span></code> command can also be used to verify the ticket was stored in the Kerberos cache:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>klist
Ticket<span class="w"> </span>cache:<span class="w"> </span>KCM:1000
Default<span class="w"> </span>principal:<span class="w"> </span>username@MY.DOMAIN.COM

Valid<span class="w"> </span>starting<span class="w">     </span>Expires<span class="w">            </span>Service<span class="w"> </span>principal
<span class="m">29</span>/08/24<span class="w"> </span><span class="m">13</span>:54:51<span class="w">  </span><span class="m">29</span>/08/24<span class="w"> </span><span class="m">23</span>:54:51<span class="w">  </span>krbtgt/MY.DOMAIN.COM@MY.DOMAIN.COM
<span class="w">        </span>renew<span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="m">05</span>/09/24<span class="w"> </span><span class="m">13</span>:54:48
<span class="m">29</span>/08/24<span class="w"> </span><span class="m">13</span>:55:30<span class="w">  </span><span class="m">29</span>/08/24<span class="w"> </span><span class="m">23</span>:55:30<span class="w">  </span>http/server.my.domain.com@MY.DOMAIN.COM
<span class="w">        </span>renew<span class="w"> </span><span class="k">until</span><span class="w"> </span><span class="m">05</span>/09/24<span class="w"> </span><span class="m">13</span>:55:30
</pre></div>
</div>
<p>In the above example we have the TGT stored under the <code class="docutils literal notranslate"><span class="pre">krbtgt</span></code> service principal and our <code class="docutils literal notranslate"><span class="pre">http/server.my.domain.com</span></code> under its own service principal.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">kdestroy</span></code> command can be used to remove the ticket cache.</p>
</section>
<section id="ticket-management">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Ticket Management</a><a class="headerlink" href="#ticket-management" title="Link to this heading"></a></h2>
<p>For Kerberos authentication to work with Ansible, a Kerberos TGT for a user must be present so that Ansible can request a service ticket for the target server. Some connection plugins like <code class="docutils literal notranslate"><span class="pre">ssh</span></code> require the TGT to already be present and accessible to the Ansible control process. Other connection plugins, like <code class="docutils literal notranslate"><span class="pre">psrp</span></code> and <code class="docutils literal notranslate"><span class="pre">winrm</span></code>, can automatically obtain a TGT for the user if the user’s password is provided in the inventory.</p>
<p>To retrieve a TGT manually for a user, run the <code class="docutils literal notranslate"><span class="pre">kinit</span></code> command with the user’s username and domain as shown in <a class="reference internal" href="#winrm-kerberos-verify-config"><span class="std std-ref">Verifying Kerberos Configuration</span></a>. This TGT will be used automatically when Kerberos authentication is requested by the connection plugin in Ansible.</p>
<p>If you are using the <code class="docutils literal notranslate"><span class="pre">psrp</span></code> or <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection plugin and the user’s password is provided in the inventory, the connection plugin will automatically obtain a TGT for the user. This is done by running the <code class="docutils literal notranslate"><span class="pre">kinit</span></code> command with the user’s username and password. The TGT will be stored in a temporary credential cache and will be used for the task.</p>
</section>
<section id="delegation">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Delegation</a><a class="headerlink" href="#delegation" title="Link to this heading"></a></h2>
<p>Kerberos delegation allows the credentials to traverse multiple hops. This is useful when you need to authenticate to a server and then have that server authenticate to another server on your behalf. To enable delegation, you must:</p>
<ul class="simple">
<li><p>request a forwardable TGT when obtaining a ticket with <code class="docutils literal notranslate"><span class="pre">kinit</span></code></p></li>
<li><p>request the connection plugin to allow delegation to the server</p></li>
<li><p>the AD user is not marked as sensitive and cannot be delegated and is not a member of the <code class="docutils literal notranslate"><span class="pre">Protected</span> <span class="pre">Users</span></code> group</p></li>
<li><p>depending on the <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> configuration, the target server may need to allow unconstrained delegation through its AD object delegation settings</p></li>
</ul>
<p>To request a forwardable TGT, either add the <code class="docutils literal notranslate"><span class="pre">-f</span></code> flag to the <code class="docutils literal notranslate"><span class="pre">kinit</span></code> command or set the <code class="docutils literal notranslate"><span class="pre">forwardable</span> <span class="pre">=</span> <span class="pre">true</span></code> option in the <code class="docutils literal notranslate"><span class="pre">[libdefaults]</span></code> section of the <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> file. If you are using the <code class="docutils literal notranslate"><span class="pre">psrp</span></code> or <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection plugin to retrieve the TGT from the user’s password in the inventory, it will automatically request a forwardable TGT if the connection plugin is configured to use delegation.</p>
<p>To have the connection plugin delegate the credentials it will need to set the following hostvar in the inventory:</p>
<div class="highlight-yaml+jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># psrp</span>
<span class="nt">ansible_psrp_negotiate_delegate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="c1"># winrm</span>
<span class="nt">ansible_winrm_kerberos_delegation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="c1"># ssh</span>
<span class="nt">ansible_ssh_common_args</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-o GSSAPIDelegateCredentials=yes</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is also possible to set <code class="docutils literal notranslate"><span class="pre">GSSAPIDelegateCredentials</span> <span class="pre">yes</span></code> in the <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> file to allow delegation for all SSH connections.</p>
</div>
<p>To verify if a user is allowed to delegate their credentials, you can run the following PowerShell script on a Windows host in the same domain:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="k">Function</span> <span class="nb">Test-IsDelegatable</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">Mandatory</span><span class="p">)]</span>
        <span class="no">[string]</span>
        <span class="nv">$UserName</span>
    <span class="p">)</span>

    <span class="nv">$NOT_DELEGATED</span> <span class="p">=</span> <span class="n">0x00100000</span>

    <span class="nv">$searcher</span> <span class="p">=</span> <span class="no">[ADSISearcher]</span><span class="s2">&quot;(&amp;(objectClass=user)(objectCategory=person)(sAMAccountName=$UserName))&quot;</span>
    <span class="nv">$res</span> <span class="p">=</span> <span class="nv">$searcher</span><span class="p">.</span><span class="n">FindOne</span><span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="nv">$res</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">Write-Error</span> <span class="n">-Message</span> <span class="s2">&quot;Failed to find user &#39;$UserName&#39;&quot;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$uac</span> <span class="p">=</span> <span class="nv">$res</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">useraccountcontrol</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>
        <span class="nv">$memberOf</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$res</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">memberof</span><span class="p">)</span>

        <span class="nv">$isSensitive</span> <span class="p">=</span> <span class="no">[bool]</span><span class="p">(</span><span class="nv">$uac</span> <span class="o">-band</span> <span class="nv">$NOT_DELEGATED</span><span class="p">)</span>
        <span class="nv">$isProtectedUser</span> <span class="p">=</span> <span class="no">[bool]</span><span class="p">(</span><span class="nv">$memberOf</span> <span class="o">-like</span> <span class="s1">&#39;CN=Protected Users,*&#39;</span><span class="p">).</span><span class="n">Count</span>

        <span class="o">-not</span> <span class="p">(</span><span class="nv">$isSensitive</span> <span class="o">-or</span> <span class="nv">$isProtectedUser</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nb">Test-IsDelegatable</span> <span class="n">-UserName</span> <span class="n">username</span>
</pre></div>
</div>
<p>Newer versions of MIT Kerberos have added a configuration option <code class="docutils literal notranslate"><span class="pre">enforce_ok_as_delegate</span></code> in the <code class="docutils literal notranslate"><span class="pre">[libdefaults]</span></code> section of the <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> file. If this option is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> delegation will only work if the target server account allows unconstrained delegation. To check or set unconstrained delegation on a Windows computer host, you can use the following PowerShell script:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="c"># Check if the server allows unconstrained delegation</span>
<span class="p">(</span><span class="nb">Get-ADComputer</span> <span class="n">-Identity</span> <span class="n">WINHOST</span> <span class="n">-Properties</span> <span class="n">TrustedForDelegation</span><span class="p">).</span><span class="n">TrustedForDelegation</span>

<span class="c"># Enable unconstrained delegation</span>
<span class="nb">Set-ADComputer</span> <span class="n">-Identity</span> <span class="n">WINHOST</span> <span class="n">-TrustedForDelegation</span> <span class="nv">$true</span>
</pre></div>
</div>
<p>To verify that delegation is working, you can use the <code class="docutils literal notranslate"><span class="pre">klist.exe</span></code> command on the Windows node to verify that the ticket has been forwarded. The output should show the ticket server is for <code class="docutils literal notranslate"><span class="pre">krbtgt/MY.DOMAIN.COM</span> <span class="pre">&#64;</span> <span class="pre">MY.CDOMAIN.COM</span></code> and the ticket flags contained <code class="docutils literal notranslate"><span class="pre">forwarded</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ansible<span class="w"> </span>WINHOST<span class="w"> </span>-m<span class="w"> </span>ansible.windows.win_command<span class="w"> </span>-a<span class="w"> </span>klist.exe

WINHOST<span class="w"> </span><span class="p">|</span><span class="w"> </span>CHANGED<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">rc</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>&gt;&gt;

Current<span class="w"> </span>LogonId<span class="w"> </span>is<span class="w"> </span><span class="m">0</span>:0x82b6977

Cached<span class="w"> </span>Tickets:<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>

<span class="c1">#0&gt;     Client: username @ MY.DOMAIN.COM</span>
<span class="w">        </span>Server:<span class="w"> </span>krbtgt/MY.DOMAIN.COM<span class="w"> </span>@<span class="w"> </span>MY.DOMAIN.COM
<span class="w">        </span>KerbTicket<span class="w"> </span>Encryption<span class="w"> </span>Type:<span class="w"> </span>AES-256-CTS-HMAC-SHA1-96
<span class="w">        </span>Ticket<span class="w"> </span>Flags<span class="w"> </span>0x60a10000<span class="w"> </span>-&gt;<span class="w"> </span>forwardable<span class="w"> </span>forwarded<span class="w"> </span>renewable<span class="w"> </span>pre_authent<span class="w"> </span>name_canonicalize
<span class="w">        </span>Start<span class="w"> </span>Time:<span class="w"> </span><span class="m">8</span>/30/2024<span class="w"> </span><span class="m">14</span>:15:18<span class="w"> </span><span class="o">(</span><span class="nb">local</span><span class="o">)</span>
<span class="w">        </span>End<span class="w"> </span>Time:<span class="w">   </span><span class="m">8</span>/31/2024<span class="w"> </span><span class="m">0</span>:12:49<span class="w"> </span><span class="o">(</span><span class="nb">local</span><span class="o">)</span>
<span class="w">        </span>Renew<span class="w"> </span>Time:<span class="w"> </span><span class="m">9</span>/6/2024<span class="w"> </span><span class="m">14</span>:12:49<span class="w"> </span><span class="o">(</span><span class="nb">local</span><span class="o">)</span>
<span class="w">        </span>Session<span class="w"> </span>Key<span class="w"> </span>Type:<span class="w"> </span>AES-256-CTS-HMAC-SHA1-96
<span class="w">        </span>Cache<span class="w"> </span>Flags:<span class="w"> </span>0x1<span class="w"> </span>-&gt;<span class="w"> </span>PRIMARY
<span class="w">        </span>Kdc<span class="w"> </span>Called:
</pre></div>
</div>
<p>If anything goes wrong, the output for <code class="docutils literal notranslate"><span class="pre">klist.exe</span></code> will not have the <code class="docutils literal notranslate"><span class="pre">forwarded</span></code> flag and the server will be for the target server principal and not <code class="docutils literal notranslate"><span class="pre">krbtgt</span></code>.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ansible<span class="w"> </span>WINHOST<span class="w"> </span>-m<span class="w"> </span>ansible.windows.win_command<span class="w"> </span>-a<span class="w"> </span>klist.exe

WINHOST<span class="w"> </span><span class="p">|</span><span class="w"> </span>CHANGED<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="nv">rc</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>&gt;&gt;

Current<span class="w"> </span>LogonId<span class="w"> </span>is<span class="w"> </span><span class="m">0</span>:0x82c312c

Cached<span class="w"> </span>Tickets:<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>

<span class="c1">#0&gt;     Client: username @ MY.DOMAIN.COM</span>
<span class="w">        </span>Server:<span class="w"> </span>http/winhost.my.domain.com<span class="w"> </span>@<span class="w"> </span>MY.DOMAIN.COM
<span class="w">        </span>KerbTicket<span class="w"> </span>Encryption<span class="w"> </span>Type:<span class="w"> </span>AES-256-CTS-HMAC-SHA1-96
<span class="w">        </span>Ticket<span class="w"> </span>Flags<span class="w"> </span>0x40a10000<span class="w"> </span>-&gt;<span class="w"> </span>forwardable<span class="w"> </span>renewable<span class="w"> </span>pre_authent<span class="w"> </span>name_canonicalize
<span class="w">        </span>Start<span class="w"> </span>Time:<span class="w"> </span><span class="m">8</span>/30/2024<span class="w"> </span><span class="m">14</span>:16:24<span class="w"> </span><span class="o">(</span><span class="nb">local</span><span class="o">)</span>
<span class="w">        </span>End<span class="w"> </span>Time:<span class="w">   </span><span class="m">8</span>/31/2024<span class="w"> </span><span class="m">0</span>:16:12<span class="w"> </span><span class="o">(</span><span class="nb">local</span><span class="o">)</span>
<span class="w">        </span>Renew<span class="w"> </span>Time:<span class="w"> </span><span class="m">0</span>
<span class="w">        </span>Session<span class="w"> </span>Key<span class="w"> </span>Type:<span class="w"> </span>AES-256-CTS-HMAC-SHA1-96
<span class="w">        </span>Cache<span class="w"> </span>Flags:<span class="w"> </span>0x8<span class="w"> </span>-&gt;<span class="w"> </span>ASC
<span class="w">        </span>Kdc<span class="w"> </span>Called:
</pre></div>
</div>
</section>
<section id="troubleshooting-kerberos">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Troubleshooting Kerberos</a><a class="headerlink" href="#troubleshooting-kerberos" title="Link to this heading"></a></h2>
<p>Kerberos is reliant on a properly configured environment to work. Some common issues that can cause Kerberos authentication to fail are:</p>
<ul class="simple">
<li><p>The hostname set for the Windows host is an alias or an IP address</p></li>
<li><p>The time on the Ansible control node is not synchronized with the AD domain controller</p></li>
<li><p>The KDC realm is not set correctly in the <code class="docutils literal notranslate"><span class="pre">krb5.conf</span></code> file or cannot be resolved through DNS</p></li>
</ul>
<p>If using the MIT Kerberos implementation, you can set the environment variable <code class="docutils literal notranslate"><span class="pre">KRB5_TRACE=/dev/stdout</span></code> to get more detailed information on what the Kerberos library is doing. This can be useful for debugging issues with the Kerberos library such as the KDC lookup behavior, time sync issues, and server name lookup failures.</p>
</section>
</section>


           </div>
          </div>
          

<footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="windows_winrm_certificate.html" class="btn btn-neutral float-left" title="WinRM Certificate Authentication" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tips_tricks/index.html" class="btn btn-neutral float-right" title="Ansible tips and tricks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Ansible project contributors.
      <span class="lastupdated">Last updated on Sep 20, 2024.
      </span></p>
  </div>

  
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->
<!-- begin analytics -->
<script>
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
      (function(d,s,i,r) {
      if (d.getElementById(i)){return;}
      var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
      n.id=i;n.src = 'https://js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
      e.parentNode.insertBefore(n, e);
      })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->
<script>
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
  _satellite.pageBottom();
}
</script>

</body>
</html>